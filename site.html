<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Automação de Orçamentos</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <div id="frame-arquivos">
            <label for="file-dxf">Arquivo DXF:</label>
            <input type="file" id="file-dxf" accept=".dxf">
            <br>
            <label for="file-excel">Arquivo Excel:</label>
            <input type="file" id="file-excel" accept=".xlsx">
            <br>
            <button id="executar-btn">Executar</button>
        </div>

        <label>
            <input type="checkbox" id="opcao-personalizada"> Opção Personalizada
        </label>

        <div id="frame-manual" style="display:none;">
            <div id="frame-topo">
                <button onclick="editarPeca()">Editar Peça</button>
                <button onclick="removerPeca()">Remover Peça</button>
                <button onclick="calcularManual()">Calcular</button>
            </div>

            <div id="frame-form">
                <label for="largura">Largura (mm):</label>
                <input type="number" id="largura">
                <label for="altura">Altura (mm):</label>
                <input type="number" id="altura">
                <label for="comprimento">Comprimento (m):</label>
                <input type="number" id="comprimento">
                <label for="espessura">Espessura (mm):</label>
                <input type="number" id="espessura">
                <button onclick="adicionarPeca()">Adicionar Peça</button>
            </div>

            <table id="pecas-table">
                <thead>
                    <tr>
                        <th>Largura (mm)</th>
                        <th>Altura (mm)</th>
                        <th>Comprimento (m)</th>
                        <th>Espessura (mm)</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Peças serão adicionadas aqui -->
                </tbody>
            </table>

            <div id="resultado"></div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
 <style>

body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
    background-color: #f4f4f9;
}

.container {
    width: 80%;
    margin: 20px auto;
}

#frame-arquivos {
    margin-bottom: 20px;
}

#frame-topo button {
    margin-right: 10px;
}

#frame-form label {
    display: block;
    margin-top: 10px;
}

#frame-form input {
    width: 100%;
    padding: 8px;
    margin-bottom: 10px;
}

button {
    padding: 10px;
    cursor: pointer;
    background-color: #4CAF50;
    color: white;
    border: none;
    border-radius: 5px;
    transition: background-color 0.3s;
}

button:hover {
    background-color: #45a049;
}

table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
}

th, td {
    border: 1px solid #ddd;
    padding: 8px;
    text-align: center;
}

#resultado {
    margin-top: 20px;
    font-weight: bold;
}

 </style>

 <script>

const PESO_CHAPA = {
    0.61: 4.88, 0.68: 5.49, 0.76: 6.1, 0.84: 6.71, 0.91: 7.32, 1.06: 8.54,
    1.21: 9.76, 1.37: 10.98, 1.52: 12.21, 1.71: 13.73, 1.9: 15.26, 2.28: 18.81,
    2.66: 21.36, 3.04: 24.41, 3.42: 27.46, 3.8: 30.52, 4.18: 33.57, 4.55: 36.62,
    4.76: 37.35, 6.35: 49.8, 7.94: 62.25, 9.53: 74.7, 12.7: 99.6, 15.88: 124.49,
    19.05: 149.39, 22.23: 174.29, 25.4: 199.19, 26.99: 211.64, 28.58: 224.09,
    30.16: 236.53, 31.75: 249.98, 33.34: 261.43, 34.93: 273.88
};
const PRECO_KG = 15.00;

let pecas = [];

document.getElementById('opcao-personalizada').addEventListener('change', function() {
    document.getElementById('frame-manual').style.display = this.checked ? 'block' : 'none';
});

function adicionarPeca() {
    const largura = parseFloat(document.getElementById('largura').value);
    const altura = parseFloat(document.getElementById('altura').value);
    const comprimento = parseFloat(document.getElementById('comprimento').value);
    const espessura = parseFloat(document.getElementById('espessura').value);

    if (largura && altura && comprimento && espessura) {
        pecas.push({ largura, altura, comprimento, espessura });
        atualizarTabela();
        limparCampos();
    } else {
        alert("Preencha todos os campos!");
    }
}

function editarPeca() {
    const index = prompt("Digite o índice da peça que deseja editar:") - 1;
    if (index >= 0 && index < pecas.length) {
        const peca = pecas[index];
        document.getElementById('largura').value = peca.largura;
        document.getElementById('altura').value = peca.altura;
        document.getElementById('comprimento').value = peca.comprimento;
        document.getElementById('espessura').value = peca.espessura;
        pecas.splice(index, 1);
        atualizarTabela();
    } else {
        alert("Índice inválido!");
    }
}

function removerPeca() {
    const index = prompt("Digite o índice da peça que deseja remover:") - 1;
    if (index >= 0 && index < pecas.length) {
        pecas.splice(index, 1);
        atualizarTabela();
    } else {
        alert("Índice inválido!");
    }
}

function calcularManual() {
    let totalPeso = 0;
    let totalPreco = 0;

    pecas.forEach(peca => {
        const { largura, altura, comprimento, espessura } = peca;
        if (!PESO_CHAPA[espessura]) {
            alert("Espessura não encontrada na tabela.");
            return;
        }

        const pesoKg = (largura / 1000) * (altura / 1000) * comprimento * PESO_CHAPA[espessura];
        const precoTotal = pesoKg * PRECO_KG;
        totalPeso += pesoKg;
        totalPreco += precoTotal;
    });

    document.getElementById('resultado').innerText = `Peso Total: ${totalPeso.toFixed(2)} kg | Preço Total: R$ ${totalPreco.toFixed(2)}`;
}

function atualizarTabela() {
    const tbody = document.querySelector('#pecas-table tbody');
    tbody.innerHTML = '';
    pecas.forEach((peca, index) => {
        const row = document.createElement('tr');
        row.innerHTML = `
            <td>${peca.largura}</td>
            <td>${peca.altura}</td>
            <td>${peca.comprimento}</td>
            <td>${peca.espessura}</td>
        `;
        tbody.appendChild(row);
    });
}

function limparCampos() {
    document.getElementById('largura').value = '';
    document.getElementById('altura').value = '';
    document.getElementById('comprimento').value = '';
    document.getElementById('espessura').value = '';
}


 </script>